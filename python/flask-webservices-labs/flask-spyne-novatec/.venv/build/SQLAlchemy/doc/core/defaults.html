<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        
        <title>
            
    
    Column Insert/Update Defaults
 &mdash;
    SQLAlchemy 1.1 Documentation

        </title>

        
            <!-- begin iterate through SQLA + sphinx environment css_files -->
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
                <link rel="stylesheet" href="../_static/changelog.css" type="text/css" />
                <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
            <!-- end iterate through SQLA + sphinx environment css_files -->
        

        

    

    <!-- begin layout.mako headers -->

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
        <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="SQLAlchemy 1.1 Documentation" href="../index.html" />
        <link rel="up" title="Schema Definition Language" href="schema.html" />
        <link rel="next" title="Defining Constraints and Indexes" href="constraints.html" />
        <link rel="prev" title="Reflecting Database Objects" href="reflection.html" />
    <!-- end layout.mako headers -->


    </head>
    <body>
        
















<div id="docs-container">





<div id="docs-top-navigation-container" class="body-background">
<div id="docs-header">
    <div id="docs-version-header">
        Release: <span class="version-num">1.1.15</span>


        | Release Date: November 3, 2017

    </div>

    <h1>SQLAlchemy 1.1 Documentation</h1>

</div>
</div>

<div id="docs-body-container">

    <div id="fixed-sidebar" class="withsidebar">


        <div id="docs-sidebar-popout">
            <h3><a href="../index.html">SQLAlchemy 1.1 Documentation</a></h3>
            <p id="sidebar-topnav">
                <a href="../contents.html">Contents</a> |
                <a href="../genindex.html">Index</a>
            </p>

            <div id="sidebar-search">
                <form class="search" action="../search.html" method="get">
                  <label>
                  Search terms:
                  <input type="text" placeholder="search..." name="q" size="12" />
                  </label>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </div>

        </div>

        <div id="docs-sidebar">

        <div id="sidebar-banner">
            
        </div>

        <div id="docs-sidebar-inner">

        
        <h3>
            <a href="index.html" title="SQLAlchemy Core">SQLAlchemy Core</a>
        </h3>

        <ul>
<li><span class="link-container first"><a class="reference external" href="tutorial.html">SQL Expression Language Tutorial</a></span></li>
<li><span class="link-container first"><a class="reference external" href="expression_api.html">SQL Statements and Expressions API</a></span></li>
<li><span class="link-container first"><a class="reference external" href="schema.html">Schema Definition Language</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="metadata.html">Describing Databases with MetaData</a></span></li>
<li><span class="link-container first"><a class="reference external" href="reflection.html">Reflecting Database Objects</a></span></li>
<li class="selected"><span class="link-container first"><strong>Column Insert/Update Defaults</strong><a class="paramlink headerlink reference internal" href="#">¶</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#scalar-defaults">Scalar Defaults</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#python-executed-functions">Python-Executed Functions</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#context-sensitive-default-functions">Context-Sensitive Default Functions</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#sql-expressions">SQL Expressions</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#server-side-defaults">Server Side Defaults</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#triggered-columns">Triggered Columns</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#defining-sequences">Defining Sequences</a></span><ul>
<li><span class="link-container first"><a class="reference external" href="#associating-a-sequence-on-a-serial-column">Associating a Sequence on a SERIAL column</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#executing-a-sequence-standalone">Executing a Sequence Standalone</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#associating-a-sequence-with-the-metadata">Associating a Sequence with the MetaData</a></span></li>
<li><span class="link-container first"><a class="reference external" href="#associating-a-sequence-as-the-server-side-default">Associating a Sequence as the Server Side Default</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="#default-objects-api">Default Objects API</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="constraints.html">Defining Constraints and Indexes</a></span></li>
<li><span class="link-container first"><a class="reference external" href="ddl.html">Customizing DDL</a></span></li>
</ul>
</li>
<li><span class="link-container first"><a class="reference external" href="types.html">Column and Data Types</a></span></li>
<li><span class="link-container first"><a class="reference external" href="engines_connections.html">Engine and Connection Use</a></span></li>
<li><span class="link-container first"><a class="reference external" href="api_basics.html">Core API Basics</a></span></li>
</ul>



        </div>

        </div>

    </div>

    

    <div id="docs-body" class="withsidebar" >
        
<span class="target" id="module-sqlalchemy.schema"></span><div class="section" id="column-insert-update-defaults">
<span id="metadata-defaults"></span><span id="metadata-defaults-toplevel"></span><h1>Column Insert/Update Defaults<a class="headerlink" href="#column-insert-update-defaults" title="Permalink to this headline">¶</a></h1>
<p>SQLAlchemy provides a very rich featureset regarding column level events which
take place during INSERT and UPDATE statements. Options include:</p>
<ul class="simple">
<li>Scalar values used as defaults during INSERT and UPDATE operations</li>
<li>Python functions which execute upon INSERT and UPDATE operations</li>
<li>SQL expressions which are embedded in INSERT statements (or in some cases execute beforehand)</li>
<li>SQL expressions which are embedded in UPDATE statements</li>
<li>Server side default values used during INSERT</li>
<li>Markers for server-side triggers used during UPDATE</li>
</ul>
<p>The general rule for all insert/update defaults is that they only take effect
if no value for a particular column is passed as an <code class="docutils literal"><span class="pre">execute()</span></code> parameter;
otherwise, the given value is used.</p>
<div class="section" id="scalar-defaults">
<h2>Scalar Defaults<a class="headerlink" href="#scalar-defaults" title="Permalink to this headline">¶</a></h2>
<p>The simplest kind of default is a scalar value used as the default value of a column:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;somecolumn&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>Above, the value “12” will be bound as the column value during an INSERT if no
other value is supplied.</p>
<p>A scalar value may also be associated with an UPDATE statement, though this is
not very common (as UPDATE statements are usually looking for dynamic
defaults):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;somecolumn&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">onupdate</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
</div>
<div class="section" id="python-executed-functions">
<h2>Python-Executed Functions<a class="headerlink" href="#python-executed-functions" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.default</span></code></a> and <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.onupdate" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.onupdate</span></code></a> keyword arguments also accept Python
functions. These functions are invoked at the time of insert or update if no
other value for that column is supplied, and the value returned is used for
the column’s value. Below illustrates a crude “sequence” that assigns an
incrementing counter to a primary key column:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># a function which counts upwards</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">def</span> <span class="nf">mydefault</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">i</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">i</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">mydefault</span><span class="p">),</span>
<span class="p">)</span></pre></div>
</div>
<p>It should be noted that for real “incrementing sequence” behavior, the
built-in capabilities of the database should normally be used, which may
include sequence objects or other autoincrementing capabilities. For primary
key columns, SQLAlchemy will in most cases use these capabilities
automatically. See the API documentation for
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> including the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.autoincrement" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.autoincrement</span></code></a> flag, as
well as the section on <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> later in this
chapter for background on standard primary key generation techniques.</p>
<p>To illustrate onupdate, we assign the Python <code class="docutils literal"><span class="pre">datetime</span></code> function <code class="docutils literal"><span class="pre">now</span></code> to
the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.onupdate" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.onupdate</span></code></a> attribute:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>

    <span class="c1"># define &#39;last_updated&#39; to be populated with datetime.now()</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;last_updated&#39;</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">,</span> <span class="n">onupdate</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">),</span>
<span class="p">)</span></pre></div>
</div>
<p>When an update statement executes and no value is passed for <code class="docutils literal"><span class="pre">last_updated</span></code>,
the <code class="docutils literal"><span class="pre">datetime.datetime.now()</span></code> Python function is executed and its return
value used as the value for <code class="docutils literal"><span class="pre">last_updated</span></code>. Notice that we provide <code class="docutils literal"><span class="pre">now</span></code>
as the function itself without calling it (i.e. there are no parenthesis
following) - SQLAlchemy will execute the function at the time the statement
executes.</p>
<div class="section" id="context-sensitive-default-functions">
<h3>Context-Sensitive Default Functions<a class="headerlink" href="#context-sensitive-default-functions" title="Permalink to this headline">¶</a></h3>
<p>The Python functions used by <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.default</span></code></a> and <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.onupdate" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.onupdate</span></code></a> may also make use of
the current statement’s context in order to determine a value. The <cite>context</cite>
of a statement is an internal SQLAlchemy object which contains all information
about the statement being executed, including its source expression, the
parameters associated with it and the cursor. The typical use case for this
context with regards to default generation is to have access to the other
values being inserted or updated on the row. To access the context, provide a
function that accepts a single <code class="docutils literal"><span class="pre">context</span></code> argument:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mydefault</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">current_parameters</span><span class="p">[</span><span class="s1">&#39;counter&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">12</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;mytable&#39;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;counter_plus_twelve&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">mydefault</span><span class="p">,</span> <span class="n">onupdate</span><span class="o">=</span><span class="n">mydefault</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>Above we illustrate a default function which will execute for all INSERT and
UPDATE statements where a value for <code class="docutils literal"><span class="pre">counter_plus_twelve</span></code> was otherwise not
provided, and the value will be that of whatever value is present in the
execution for the <code class="docutils literal"><span class="pre">counter</span></code> column, plus the number 12.</p>
<p>While the context object passed to the default function has many attributes,
the <code class="docutils literal"><span class="pre">current_parameters</span></code> member is a special member provided only during the
execution of a default function for the purposes of deriving defaults from its
existing values. For a single statement that is executing many sets of bind
parameters, the user-defined function is called for each set of parameters,
and <code class="docutils literal"><span class="pre">current_parameters</span></code> will be provided with each individual parameter set
for each execution.</p>
</div>
</div>
<div class="section" id="sql-expressions">
<h2>SQL Expressions<a class="headerlink" href="#sql-expressions" title="Permalink to this headline">¶</a></h2>
<p>The “default” and “onupdate” keywords may also be passed SQL expressions,
including select statements or direct function calls:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>

    <span class="c1"># define &#39;create_date&#39; to default to now()</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;create_date&#39;</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">now</span><span class="p">()),</span>

    <span class="c1"># define &#39;key&#39; to pull its default from the &#39;keyvalues&#39; table</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="n">keyvalues</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">keyvalues</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="s1">&#39;type1&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>

    <span class="c1"># define &#39;last_modified&#39; to use the current_timestamp SQL function on update</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;last_modified&#39;</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">,</span> <span class="n">onupdate</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">utc_timestamp</span><span class="p">())</span>
    <span class="p">)</span></pre></div>
</div>
<p>Above, the <code class="docutils literal"><span class="pre">create_date</span></code> column will be populated with the result of the
<code class="docutils literal"><span class="pre">now()</span></code> SQL function (which, depending on backend, compiles into <code class="docutils literal"><span class="pre">NOW()</span></code>
or <code class="docutils literal"><span class="pre">CURRENT_TIMESTAMP</span></code> in most cases) during an INSERT statement, and the
<code class="docutils literal"><span class="pre">key</span></code> column with the result of a SELECT subquery from another table. The
<code class="docutils literal"><span class="pre">last_modified</span></code> column will be populated with the value of
<code class="docutils literal"><span class="pre">UTC_TIMESTAMP()</span></code>, a function specific to MySQL, when an UPDATE statement is
emitted for this table.</p>
<p>Note that when using <code class="docutils literal"><span class="pre">func</span></code> functions, unlike when using Python <cite>datetime</cite>
functions we <em>do</em> call the function, i.e. with parenthesis “()” - this is
because what we want in this case is the return value of the function, which
is the SQL expression construct that will be rendered into the INSERT or
UPDATE statement.</p>
<p>The above SQL functions are usually executed “inline” with the INSERT or
UPDATE statement being executed, meaning, a single statement is executed which
embeds the given expressions or subqueries within the VALUES or SET clause of
the statement. Although in some cases, the function is “pre-executed” in a
SELECT statement of its own beforehand. This happens when all of the following
is true:</p>
<ul class="simple">
<li>the column is a primary key column</li>
<li>the database dialect does not support a usable <code class="docutils literal"><span class="pre">cursor.lastrowid</span></code> accessor
(or equivalent); this currently includes PostgreSQL, Oracle, and Firebird, as
well as some MySQL dialects.</li>
<li>the dialect does not support the “RETURNING” clause or similar, or the
<code class="docutils literal"><span class="pre">implicit_returning</span></code> flag is set to <code class="docutils literal"><span class="pre">False</span></code> for the dialect. Dialects
which support RETURNING currently include PostgreSQL, Oracle, Firebird, and
MS-SQL.</li>
<li>the statement is a single execution, i.e. only supplies one set of
parameters and doesn’t use “executemany” behavior</li>
<li>the <code class="docutils literal"><span class="pre">inline=True</span></code> flag is not set on the
<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert()</span></code></a> or
<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Update" title="sqlalchemy.sql.expression.Update"><code class="xref py py-class docutils literal"><span class="pre">Update()</span></code></a> construct, and the statement has
not defined an explicit <cite>returning()</cite> clause.</li>
</ul>
<p>Whether or not the default generation clause “pre-executes” is not something
that normally needs to be considered, unless it is being addressed for
performance reasons.</p>
<p>When the statement is executed with a single set of parameters (that is, it is
not an “executemany” style execution), the returned
<a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a> will contain a collection
accessible via <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.postfetch_cols" title="sqlalchemy.engine.ResultProxy.postfetch_cols"><code class="xref py py-meth docutils literal"><span class="pre">ResultProxy.postfetch_cols()</span></code></a> which contains a list of all
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> objects which had an inline-executed
default. Similarly, all parameters which were bound to the statement,
including all Python and SQL expressions which were pre-executed, are present
in the <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.last_inserted_params" title="sqlalchemy.engine.ResultProxy.last_inserted_params"><code class="xref py py-meth docutils literal"><span class="pre">ResultProxy.last_inserted_params()</span></code></a> or <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.last_updated_params" title="sqlalchemy.engine.ResultProxy.last_updated_params"><code class="xref py py-meth docutils literal"><span class="pre">ResultProxy.last_updated_params()</span></code></a> collections on
<a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a>. The <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.inserted_primary_key" title="sqlalchemy.engine.ResultProxy.inserted_primary_key"><code class="xref py py-attr docutils literal"><span class="pre">ResultProxy.inserted_primary_key</span></code></a>
collection contains a list of primary key values for the row inserted (a list
so that single-column and composite-column primary keys are represented in the
same format).</p>
</div>
<div class="section" id="server-side-defaults">
<span id="server-defaults"></span><h2>Server Side Defaults<a class="headerlink" href="#server-side-defaults" title="Permalink to this headline">¶</a></h2>
<p>A variant on the SQL expression default is the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.server_default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.server_default</span></code></a>, which gets
placed in the CREATE TABLE statement during a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.create" title="sqlalchemy.schema.Table.create"><code class="xref py py-meth docutils literal"><span class="pre">Table.create()</span></code></a> operation:</p>
<div class="highlight-python+sql"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">server_default</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">,</span> <span class="n">server_default</span><span class="o">=</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;sysdate&quot;</span><span class="p">))</span>
<span class="p">)</span></pre></div>
</div>
<p>A create call for the above table will produce:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">test</span> <span class="p">(</span>
    <span class="n">abc</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">default</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span>
    <span class="n">created_at</span> <span class="n">datetime</span> <span class="n">default</span> <span class="n">sysdate</span>
<span class="p">)</span></pre></div>
</div>
<p>The behavior of <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.server_default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.server_default</span></code></a> is similar to that of a regular SQL
default; if it’s placed on a primary key column for a database which doesn’t
have a way to “postfetch” the ID, and the statement is not “inlined”, the SQL
expression is pre-executed; otherwise, SQLAlchemy lets the default fire off on
the database side normally.</p>
</div>
<div class="section" id="triggered-columns">
<span id="id1"></span><h2>Triggered Columns<a class="headerlink" href="#triggered-columns" title="Permalink to this headline">¶</a></h2>
<p>Columns with values set by a database trigger or other external process may be
called out using <a class="reference internal" href="#sqlalchemy.schema.FetchedValue" title="sqlalchemy.schema.FetchedValue"><code class="xref py py-class docutils literal"><span class="pre">FetchedValue</span></code></a> as a marker:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">server_default</span><span class="o">=</span><span class="n">FetchedValue</span><span class="p">()),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;def&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">server_onupdate</span><span class="o">=</span><span class="n">FetchedValue</span><span class="p">())</span>
<span class="p">)</span></pre></div>
</div>
<p>These markers do not emit a “default” clause when the table is created,
however they do set the same internal flags as a static <code class="docutils literal"><span class="pre">server_default</span></code>
clause, providing hints to higher-level tools that a “post-fetch” of these
rows should be performed after an insert or update.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It’s generally not appropriate to use <a class="reference internal" href="#sqlalchemy.schema.FetchedValue" title="sqlalchemy.schema.FetchedValue"><code class="xref py py-class docutils literal"><span class="pre">FetchedValue</span></code></a> in
conjunction with a primary key column, particularly when using the
ORM or any other scenario where the <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.inserted_primary_key" title="sqlalchemy.engine.ResultProxy.inserted_primary_key"><code class="xref py py-attr docutils literal"><span class="pre">ResultProxy.inserted_primary_key</span></code></a>
attribute is required.  This is becaue the “post-fetch” operation requires
that the primary key value already be available, so that the
row can be selected on its primary key.</p>
<p>For a server-generated primary key value, all databases provide special
accessors or other techniques in order to acquire the “last inserted
primary key” column of a table.  These mechanisms aren’t affected by the presence
of <a class="reference internal" href="#sqlalchemy.schema.FetchedValue" title="sqlalchemy.schema.FetchedValue"><code class="xref py py-class docutils literal"><span class="pre">FetchedValue</span></code></a>.  For special situations where triggers are
used to generate primary key values, and the database in use does not
support the <code class="docutils literal"><span class="pre">RETURNING</span></code> clause, it may be necessary to forego the usage
of the trigger and instead apply the SQL expression or function as a
“pre execute” expression:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="n">MyType</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">generate_new_value</span><span class="p">(),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p class="last">Where above, when <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.insert" title="sqlalchemy.schema.Table.insert"><code class="xref py py-meth docutils literal"><span class="pre">Table.insert()</span></code></a> is used,
the <code class="docutils literal"><span class="pre">func.generate_new_value()</span></code> expression will be pre-executed
in the context of a scalar <code class="docutils literal"><span class="pre">SELECT</span></code> statement, and the new value will
be applied to the subsequent <code class="docutils literal"><span class="pre">INSERT</span></code>, while at the same time being
made available to the <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.inserted_primary_key" title="sqlalchemy.engine.ResultProxy.inserted_primary_key"><code class="xref py py-attr docutils literal"><span class="pre">ResultProxy.inserted_primary_key</span></code></a>
attribute.</p>
</div>
</div>
<div class="section" id="defining-sequences">
<h2>Defining Sequences<a class="headerlink" href="#defining-sequences" title="Permalink to this headline">¶</a></h2>
<p>SQLAlchemy represents database sequences using the
<a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> object, which is considered to be a
special case of “column default”. It only has an effect on databases which
have explicit support for sequences, which currently includes PostgreSQL,
Oracle, and Firebird. The <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> object is
otherwise ignored.</p>
<p>The <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> may be placed on any column as a
“default” generator to be used during INSERT operations, and can also be
configured to fire off during UPDATE operations if desired. It is most
commonly used in conjunction with a single integer primary key column:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;cartitems&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span>
        <span class="s2">&quot;cart_id&quot;</span><span class="p">,</span>
        <span class="n">Integer</span><span class="p">,</span>
        <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;cart_id_seq&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">40</span><span class="p">)),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;createdate&quot;</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">())</span>
<span class="p">)</span></pre></div>
</div>
<p>Where above, the table “cartitems” is associated with a sequence named
“cart_id_seq”. When INSERT statements take place for “cartitems”, and no value
is passed for the “cart_id” column, the “cart_id_seq” sequence will be used to
generate a value.   Typically, the sequence function is embedded in the
INSERT statement, which is combined with RETURNING so that the newly generated
value can be returned to the Python code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">cartitems</span> <span class="p">(</span><span class="n">cart_id</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">createdate</span><span class="p">)</span>
<span class="n">VALUES</span> <span class="p">(</span><span class="n">next_val</span><span class="p">(</span><span class="n">cart_id_seq</span><span class="p">),</span> <span class="s1">&#39;some description&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-10-15 12:00:15&#39;</span><span class="p">)</span>
<span class="n">RETURNING</span> <span class="n">cart_id</span></pre></div>
</div>
<p>When the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> is associated with a
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> as its <strong>Python-side</strong> default generator, the
<a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> will also be subject to “CREATE SEQUENCE” and “DROP
SEQUENCE” DDL when similar DDL is emitted for the owning <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>.
This is a limited scope convenience feature that does not accommodate for
inheritance of other aspects of the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>, such as the default
schema.  Therefore, it is best practice that for a <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> which
is local to a certain <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> / <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>, that it be
explicitly associated with the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> using the
<a class="reference internal" href="#sqlalchemy.schema.Sequence.params.metadata" title="sqlalchemy.schema.Sequence"><code class="xref py py-paramref docutils literal"><span class="pre">Sequence.metadata</span></code></a> parameter.  See the section
<a class="reference internal" href="#sequence-metadata"><span class="std std-ref">Associating a Sequence with the MetaData</span></a> for more background on this.</p>
<div class="section" id="associating-a-sequence-on-a-serial-column">
<h3>Associating a Sequence on a SERIAL column<a class="headerlink" href="#associating-a-sequence-on-a-serial-column" title="Permalink to this headline">¶</a></h3>
<p>PostgreSQL’s SERIAL datatype is an auto-incrementing type that implies
the implicit creation of a PostgreSQL sequence when CREATE TABLE is emitted.
If a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> specifies an explicit <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> object
which also specifies a true value for the <a class="reference internal" href="#sqlalchemy.schema.Sequence.params.optional" title="sqlalchemy.schema.Sequence"><code class="xref py py-paramref docutils literal"><span class="pre">Sequence.optional</span></code></a>
boolean flag, the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> will not take effect under PostgreSQL,
and the SERIAL datatype will proceed normally.   Instead, the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>
will only take effect when used against other sequence-supporting
databases, currently Oracle and Firebird.</p>
</div>
<div class="section" id="executing-a-sequence-standalone">
<h3>Executing a Sequence Standalone<a class="headerlink" href="#executing-a-sequence-standalone" title="Permalink to this headline">¶</a></h3>
<p>A SEQUENCE is a first class schema object in SQL and can be used to generate
values independently in the database.   If you have a <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>
object, it can be invoked with its “next value” instruction by
passing it directly to a SQL execution method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">my_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;some_sequence&#39;</span><span class="p">)</span>
    <span class="n">nextid</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span></pre></div>
</div>
<p>In order to embed the “next value” function of a <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>
inside of a SQL statement like a SELECT or INSERT, use the <a class="reference internal" href="#sqlalchemy.schema.Sequence.next_value" title="sqlalchemy.schema.Sequence.next_value"><code class="xref py py-meth docutils literal"><span class="pre">Sequence.next_value()</span></code></a>
method, which will render at statement compilation time a SQL function that is
appropriate for the target backend:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;some_sequence&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">my_seq</span><span class="o">.</span><span class="n">next_value</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">stmt</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">dialect</span><span class="o">=</span><span class="n">postgresql</span><span class="o">.</span><span class="n">dialect</span><span class="p">())</span>
<span class="go">SELECT nextval(&#39;some_sequence&#39;) AS next_value_1</span></pre></div>
</div>
</div>
<div class="section" id="associating-a-sequence-with-the-metadata">
<span id="sequence-metadata"></span><h3>Associating a Sequence with the MetaData<a class="headerlink" href="#associating-a-sequence-with-the-metadata" title="Permalink to this headline">¶</a></h3>
<p>For many years, the SQLAlchemy documentation referred to the
example of associating a <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> with a table as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;cartitems&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;cart_id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;cart_id_seq&#39;</span><span class="p">),</span>
           <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">40</span><span class="p">)),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;createdate&quot;</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">())</span>
<span class="p">)</span></pre></div>
</div>
<p>While the above is a prominent idiomatic pattern, it is recommended that
the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> in most cases be explicitly associated with the
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>, using the <a class="reference internal" href="#sqlalchemy.schema.Sequence.params.metadata" title="sqlalchemy.schema.Sequence"><code class="xref py py-paramref docutils literal"><span class="pre">Sequence.metadata</span></code></a> parameter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;cartitems&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span>
        <span class="s2">&quot;cart_id&quot;</span><span class="p">,</span>
        <span class="n">Integer</span><span class="p">,</span>
        <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;cart_id_seq&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">40</span><span class="p">)),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;createdate&quot;</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">())</span>
<span class="p">)</span></pre></div>
</div>
<p>The <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> object is a first class
schema construct that can exist independently of any table in a database, and
can also be shared among tables.   Therefore SQLAlchemy does not implicitly
modify the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> when it is associated with a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>
object as either the Python-side or server-side default  generator.  While the
CREATE SEQUENCE / DROP SEQUENCE DDL is emitted for a  <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>
defined as a Python side generator at the same time the table itself is subject
to CREATE or DROP, this is a convenience feature that does not imply that the
<a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> is fully associated with the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> object.</p>
<p>Explicitly associating the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> with <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>
allows for the following behaviors:</p>
<ul class="simple">
<li>The <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> will inherit the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.params.schema" title="sqlalchemy.schema.MetaData"><code class="xref py py-paramref docutils literal"><span class="pre">MetaData.schema</span></code></a>
parameter specified to the target <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>, which
affects the production of CREATE / DROP DDL, if any.</li>
<li>The <a class="reference internal" href="#sqlalchemy.schema.Sequence.create" title="sqlalchemy.schema.Sequence.create"><code class="xref py py-meth docutils literal"><span class="pre">Sequence.create()</span></code></a> and <a class="reference internal" href="#sqlalchemy.schema.Sequence.drop" title="sqlalchemy.schema.Sequence.drop"><code class="xref py py-meth docutils literal"><span class="pre">Sequence.drop()</span></code></a> methods
automatically use the engine bound to the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>
object, if any.</li>
<li>The <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.create_all" title="sqlalchemy.schema.MetaData.create_all"><code class="xref py py-meth docutils literal"><span class="pre">MetaData.create_all()</span></code></a> and <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.drop_all" title="sqlalchemy.schema.MetaData.drop_all"><code class="xref py py-meth docutils literal"><span class="pre">MetaData.drop_all()</span></code></a>
methods will emit CREATE / DROP for this <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>,
even if the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> is not associated with any
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> / <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> that’s a member of this
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>.</li>
</ul>
<p>Since the vast majority of cases that deal with <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> expect
that <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> to be fully “owned” by the assocated <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>
and that options like default schema are propagated, setting the
<a class="reference internal" href="#sqlalchemy.schema.Sequence.params.metadata" title="sqlalchemy.schema.Sequence"><code class="xref py py-paramref docutils literal"><span class="pre">Sequence.metadata</span></code></a> parameter should be considered a best practice.</p>
</div>
<div class="section" id="associating-a-sequence-as-the-server-side-default">
<h3>Associating a Sequence as the Server Side Default<a class="headerlink" href="#associating-a-sequence-as-the-server-side-default" title="Permalink to this headline">¶</a></h3>
<p>The preceding sections illustrate how to associate a <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> with a
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> as the <strong>Python side default generator</strong>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="p">(</span>
    <span class="s2">&quot;cart_id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;cart_id_seq&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">),</span>
    <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>In the above case, the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> will automatically be subject
to CREATE SEQUENCE / DROP SEQUENCE DDL when the related <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>
is subject to CREATE / DROP.  However, the sequence will <strong>not</strong> be present
as the server-side default for the column when CREATE TABLE is emitted.</p>
<p>If we want the sequence to be used as a server-side default,
meaning it takes place even if we emit INSERT commands to the table from
the SQL command line, we can use the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.server_default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal"><span class="pre">Column.server_default</span></code></a>
parameter in conjunction with the value-generation function of the
sequence, available from the <a class="reference internal" href="#sqlalchemy.schema.Sequence.next_value" title="sqlalchemy.schema.Sequence.next_value"><code class="xref py py-meth docutils literal"><span class="pre">Sequence.next_value()</span></code></a> method.  Below
we illustrate the same <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> being associated with the
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> both as the Python-side default generator as well as
the server-side default generator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cart_id_seq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;cart_id_seq&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;cartitems&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span>
        <span class="s2">&quot;cart_id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">cart_id_seq</span><span class="p">,</span>
        <span class="n">server_default</span><span class="o">=</span><span class="n">cart_id_seq</span><span class="o">.</span><span class="n">next_value</span><span class="p">(),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">40</span><span class="p">)),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;createdate&quot;</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">())</span>
<span class="p">)</span></pre></div>
</div>
<p>or with the ORM:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CartItem</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;cartitems&#39;</span>

    <span class="n">cart_id_seq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;cart_id_seq&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
    <span class="n">cart_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">Integer</span><span class="p">,</span> <span class="n">cart_id_seq</span><span class="p">,</span>
        <span class="n">server_default</span><span class="o">=</span><span class="n">cart_id_seq</span><span class="o">.</span><span class="n">next_value</span><span class="p">(),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
    <span class="n">createdate</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">DateTime</span><span class="p">)</span></pre></div>
</div>
<p>When the “CREATE TABLE” statement is emitted, on PostgreSQL it would be
emitted as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">cartitems</span> <span class="p">(</span>
    <span class="n">cart_id</span> <span class="n">INTEGER</span> <span class="n">DEFAULT</span> <span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;cart_id_seq&#39;</span><span class="p">)</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
    <span class="n">description</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
    <span class="n">createdate</span> <span class="n">TIMESTAMP</span> <span class="n">WITHOUT</span> <span class="n">TIME</span> <span class="n">ZONE</span><span class="p">,</span>
    <span class="n">PRIMARY</span> <span class="n">KEY</span> <span class="p">(</span><span class="n">cart_id</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>Placement of the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> in both the Python-side and server-side
default generation contexts ensures that the “primary key fetch” logic
works in all cases.  Typically, sequence-enabled databases also support
RETURNING for INSERT statements, which is used automatically by SQLAlchemy
when emitting this statement.  However if RETURNING is not used for a particular
insert, then SQLAlchemy would prefer to “pre-execute” the sequence outside
of the INSERT statement itself, which only works if the sequence is
included as the Python-side default generator function.</p>
<p>The example also associates the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> with the enclosing
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> directly, which again ensures that the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>
is fully associated with the parameters of the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> collection
including the default schema, if any.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/postgresql.html#postgresql-sequences"><span class="std std-ref">Sequences/SERIAL/IDENTITY</span></a> - in the PostgreSQL dialect documentation</p>
<p class="last"><a class="reference internal" href="../dialects/oracle.html#oracle-returning"><span class="std std-ref">RETURNING Support</span></a> - in the Oracle dialect documentation</p>
</div>
</div>
</div>
<div class="section" id="default-objects-api">
<h2>Default Objects API<a class="headerlink" href="#default-objects-api" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy.schema.ColumnDefault">
<em class="property">class </em><code class="descclassname">sqlalchemy.schema.</code><code class="descname">ColumnDefault</code><span class="sig-paren">(</span><em>arg</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.ColumnDefault" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.schema.DefaultGenerator" title="sqlalchemy.schema.DefaultGenerator"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.schema.DefaultGenerator</span></code></a></p>
<p>A plain default value on a column.</p>
<p>This could correspond to a constant, a callable function,
or a SQL clause.</p>
<p><a class="reference internal" href="#sqlalchemy.schema.ColumnDefault" title="sqlalchemy.schema.ColumnDefault"><code class="xref py py-class docutils literal"><span class="pre">ColumnDefault</span></code></a> is generated automatically
whenever the <code class="docutils literal"><span class="pre">default</span></code>, <code class="docutils literal"><span class="pre">onupdate</span></code> arguments of
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> are used.  A <a class="reference internal" href="#sqlalchemy.schema.ColumnDefault" title="sqlalchemy.schema.ColumnDefault"><code class="xref py py-class docutils literal"><span class="pre">ColumnDefault</span></code></a>
can be passed positionally as well.</p>
<p>For example, the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span></pre></div>
</div>
<p>Is equivalent to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">ColumnDefault</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span></pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.schema.DefaultClause">
<em class="property">class </em><code class="descclassname">sqlalchemy.schema.</code><code class="descname">DefaultClause</code><span class="sig-paren">(</span><em>arg</em>, <em>for_update=False</em>, <em>_reflected=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.DefaultClause" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.schema.FetchedValue" title="sqlalchemy.schema.FetchedValue"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.schema.FetchedValue</span></code></a></p>
<p>A DDL-specified DEFAULT column value.</p>
<p><a class="reference internal" href="#sqlalchemy.schema.DefaultClause" title="sqlalchemy.schema.DefaultClause"><code class="xref py py-class docutils literal"><span class="pre">DefaultClause</span></code></a> is a <a class="reference internal" href="#sqlalchemy.schema.FetchedValue" title="sqlalchemy.schema.FetchedValue"><code class="xref py py-class docutils literal"><span class="pre">FetchedValue</span></code></a>
that also generates a “DEFAULT” clause when
“CREATE TABLE” is emitted.</p>
<p><a class="reference internal" href="#sqlalchemy.schema.DefaultClause" title="sqlalchemy.schema.DefaultClause"><code class="xref py py-class docutils literal"><span class="pre">DefaultClause</span></code></a> is generated automatically
whenever the <code class="docutils literal"><span class="pre">server_default</span></code>, <code class="docutils literal"><span class="pre">server_onupdate</span></code> arguments of
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> are used.  A <a class="reference internal" href="#sqlalchemy.schema.DefaultClause" title="sqlalchemy.schema.DefaultClause"><code class="xref py py-class docutils literal"><span class="pre">DefaultClause</span></code></a>
can be passed positionally as well.</p>
<p>For example, the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">server_default</span><span class="o">=</span><span class="s2">&quot;50&quot;</span><span class="p">)</span></pre></div>
</div>
<p>Is equivalent to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">DefaultClause</span><span class="p">(</span><span class="s2">&quot;50&quot;</span><span class="p">))</span></pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.schema.DefaultGenerator">
<em class="property">class </em><code class="descclassname">sqlalchemy.schema.</code><code class="descname">DefaultGenerator</code><span class="sig-paren">(</span><em>for_update=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.DefaultGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.schema._NotAColumnExpr</span></code>, <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.schema.SchemaItem</span></code></a></p>
<p>Base class for column <em>default</em> values.</p>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.schema.FetchedValue">
<em class="property">class </em><code class="descclassname">sqlalchemy.schema.</code><code class="descname">FetchedValue</code><span class="sig-paren">(</span><em>for_update=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.FetchedValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.schema._NotAColumnExpr</span></code>, <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.sql.expression.SchemaEventTarget</span></code></p>
<p>A marker for a transparent database-side default.</p>
<p>Use <a class="reference internal" href="#sqlalchemy.schema.FetchedValue" title="sqlalchemy.schema.FetchedValue"><code class="xref py py-class docutils literal"><span class="pre">FetchedValue</span></code></a> when the database is configured
to provide some automatic default for a column.</p>
<p>E.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">FetchedValue</span><span class="p">())</span></pre></div>
</div>
<p>Would indicate that some trigger or default generator
will create a new value for the <code class="docutils literal"><span class="pre">foo</span></code> column during an
INSERT.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#triggered-columns"><span class="std std-ref">Triggered Columns</span></a></p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.schema.PassiveDefault">
<em class="property">class </em><code class="descclassname">sqlalchemy.schema.</code><code class="descname">PassiveDefault</code><span class="sig-paren">(</span><em>*arg</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.PassiveDefault" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.schema.DefaultClause" title="sqlalchemy.schema.DefaultClause"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.schema.DefaultClause</span></code></a></p>
<p>A DDL-specified DEFAULT column value.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.6: </span><a class="reference internal" href="#sqlalchemy.schema.PassiveDefault" title="sqlalchemy.schema.PassiveDefault"><code class="xref py py-class docutils literal"><span class="pre">PassiveDefault</span></code></a> is deprecated.
Use <a class="reference internal" href="#sqlalchemy.schema.DefaultClause" title="sqlalchemy.schema.DefaultClause"><code class="xref py py-class docutils literal"><span class="pre">DefaultClause</span></code></a>.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="sqlalchemy.schema.Sequence">
<em class="property">class </em><code class="descclassname">sqlalchemy.schema.</code><code class="descname">Sequence</code><span class="sig-paren">(</span><em>name</em>, <em>start=None</em>, <em>increment=None</em>, <em>minvalue=None</em>, <em>maxvalue=None</em>, <em>nominvalue=None</em>, <em>nomaxvalue=None</em>, <em>cycle=None</em>, <em>schema=None</em>, <em>cache=None</em>, <em>order=None</em>, <em>optional=False</em>, <em>quote=None</em>, <em>metadata=None</em>, <em>quote_schema=None</em>, <em>for_update=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.Sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.schema.DefaultGenerator" title="sqlalchemy.schema.DefaultGenerator"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.schema.DefaultGenerator</span></code></a></p>
<p>Represents a named database sequence.</p>
<p>The <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> object represents the name and configurational
parameters of a database sequence.   It also represents
a construct that can be “executed” by a SQLAlchemy <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>
or <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>, rendering the appropriate “next value” function
for the target database and returning a result.</p>
<p>The <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> is typically associated with a primary key column:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">some_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;some_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&#39;some_table_seq&#39;</span><span class="p">),</span>
    <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>When CREATE TABLE is emitted for the above <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>, if the
target platform supports sequences, a CREATE SEQUENCE statement will
be emitted as well.   For platforms that don’t support sequences,
the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> construct is ignored.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p><a class="reference internal" href="ddl.html#sqlalchemy.schema.CreateSequence" title="sqlalchemy.schema.CreateSequence"><code class="xref py py-class docutils literal"><span class="pre">CreateSequence</span></code></a></p>
<p class="last"><a class="reference internal" href="ddl.html#sqlalchemy.schema.DropSequence" title="sqlalchemy.schema.DropSequence"><code class="xref py py-class docutils literal"><span class="pre">DropSequence</span></code></a></p>
</div>
<dl class="method">
<dt id="sqlalchemy.schema.Sequence.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>start=None</em>, <em>increment=None</em>, <em>minvalue=None</em>, <em>maxvalue=None</em>, <em>nominvalue=None</em>, <em>nomaxvalue=None</em>, <em>cycle=None</em>, <em>schema=None</em>, <em>cache=None</em>, <em>order=None</em>, <em>optional=False</em>, <em>quote=None</em>, <em>metadata=None</em>, <em>quote_schema=None</em>, <em>for_update=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.Sequence.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="sqlalchemy.schema.Sequence.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.name">¶</a> – The name of the sequence.</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.start"></span><strong>start</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.start">¶</a> – the starting index of the sequence.  This value is
used when the CREATE SEQUENCE command is emitted to the database
as the value of the “START WITH” clause.   If <code class="docutils literal"><span class="pre">None</span></code>, the
clause is omitted, which on most platforms indicates a starting
value of 1.</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.increment"></span><strong>increment</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.increment">¶</a> – the increment value of the sequence.  This
value is used when the CREATE SEQUENCE command is emitted to
the database as the value of the “INCREMENT BY” clause.  If <code class="docutils literal"><span class="pre">None</span></code>,
the clause is omitted, which on most platforms indicates an
increment of 1.</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.minvalue"></span><strong>minvalue</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.minvalue">¶</a> – <p>the minimum value of the sequence.  This
value is used when the CREATE SEQUENCE command is emitted to
the database as the value of the “MINVALUE” clause.  If <code class="docutils literal"><span class="pre">None</span></code>,
the clause is omitted, which on most platforms indicates a
minvalue of 1 and -2^63-1 for ascending and descending sequences,
respectively.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.7.</span></p>
</div>
</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.maxvalue"></span><strong>maxvalue</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.maxvalue">¶</a> – <p>the maximum value of the sequence.  This
value is used when the CREATE SEQUENCE command is emitted to
the database as the value of the “MAXVALUE” clause.  If <code class="docutils literal"><span class="pre">None</span></code>,
the clause is omitted, which on most platforms indicates a
maxvalue of 2^63-1 and -1 for ascending and descending sequences,
respectively.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.7.</span></p>
</div>
</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.nominvalue"></span><strong>nominvalue</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.nominvalue">¶</a> – <p>no minimum value of the sequence.  This
value is used when the CREATE SEQUENCE command is emitted to
the database as the value of the “NO MINVALUE” clause.  If <code class="docutils literal"><span class="pre">None</span></code>,
the clause is omitted, which on most platforms indicates a
minvalue of 1 and -2^63-1 for ascending and descending sequences,
respectively.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.7.</span></p>
</div>
</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.nomaxvalue"></span><strong>nomaxvalue</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.nomaxvalue">¶</a> – <p>no maximum value of the sequence.  This
value is used when the CREATE SEQUENCE command is emitted to
the database as the value of the “NO MAXVALUE” clause.  If <code class="docutils literal"><span class="pre">None</span></code>,
the clause is omitted, which on most platforms indicates a
maxvalue of 2^63-1 and -1 for ascending and descending sequences,
respectively.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.7.</span></p>
</div>
</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.cycle"></span><strong>cycle</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.cycle">¶</a> – <p>allows the sequence to wrap around when the maxvalue
or minvalue has been reached by an ascending or descending sequence
respectively.  This value is used when the CREATE SEQUENCE command
is emitted to the database as the “CYCLE” clause.  If the limit is
reached, the next number generated will be the minvalue or maxvalue,
respectively.  If cycle=False (the default) any calls to nextval
after the sequence has reached its maximum value will return an
error.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.7.</span></p>
</div>
</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.schema"></span><strong>schema</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.schema">¶</a> – Optional schema name for the sequence, if located
in a schema other than the default.  The rules for selecting the
schema name when a <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> is also present are the same
as that of <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.params.schema" title="sqlalchemy.schema.Table"><code class="xref py py-paramref docutils literal"><span class="pre">Table.schema</span></code></a>.</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.cache"></span><strong>cache</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.cache">¶</a> – <p>optional integer value; number of future values in the
sequence which are calculated in advance.  Renders the CACHE keyword
understood by Oracle and PostgreSQL.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.1.12.</span></p>
</div>
</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.order"></span><strong>order</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.order">¶</a> – <p>optional boolean value; if true, renders the
ORDER keyword, understood by Oracle, indicating the sequence is
definitively ordered.   May be necessary to provide deterministic
ordering using Oracle RAC.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.1.12.</span></p>
</div>
</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.optional"></span><strong>optional</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.optional">¶</a> – boolean value, when <code class="docutils literal"><span class="pre">True</span></code>, indicates that this
<a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> object only needs to be explicitly generated
on backends that don’t provide another way to generate primary
key identifiers.  Currently, it essentially means, “don’t create
this sequence on the PostgreSQL backend, where the SERIAL keyword
creates a sequence for us automatically”.</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.quote"></span><strong>quote</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.quote">¶</a> – boolean value, when <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code>, explicitly
forces quoting of the schema name on or off.  When left at its
default of <code class="docutils literal"><span class="pre">None</span></code>, normal quoting rules based on casing and
reserved words take place.</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.quote_schema"></span><strong>quote_schema</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.quote_schema">¶</a> – set the quoting preferences for the <code class="docutils literal"><span class="pre">schema</span></code>
name.</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.metadata"></span><strong>metadata</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.metadata">¶</a> – <p>optional <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> object which this
<a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> will be associated with.  A <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>
that is associated with a <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> gains the following
capabilities:</p>
<ul>
<li>The <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> will inherit the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.params.schema" title="sqlalchemy.schema.MetaData"><code class="xref py py-paramref docutils literal"><span class="pre">MetaData.schema</span></code></a>
parameter specified to the target <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>, which
affects the production of CREATE / DROP DDL, if any.</li>
<li>The <a class="reference internal" href="#sqlalchemy.schema.Sequence.create" title="sqlalchemy.schema.Sequence.create"><code class="xref py py-meth docutils literal"><span class="pre">Sequence.create()</span></code></a> and <a class="reference internal" href="#sqlalchemy.schema.Sequence.drop" title="sqlalchemy.schema.Sequence.drop"><code class="xref py py-meth docutils literal"><span class="pre">Sequence.drop()</span></code></a> methods
automatically use the engine bound to the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>
object, if any.</li>
<li>The <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.create_all" title="sqlalchemy.schema.MetaData.create_all"><code class="xref py py-meth docutils literal"><span class="pre">MetaData.create_all()</span></code></a> and <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.drop_all" title="sqlalchemy.schema.MetaData.drop_all"><code class="xref py py-meth docutils literal"><span class="pre">MetaData.drop_all()</span></code></a>
methods will emit CREATE / DROP for this <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>,
even if the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> is not associated with any
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> / <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> that’s a member of this
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>.</li>
</ul>
<p>The above behaviors can only occur if the <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> is
explicitly associated with the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> via this parameter.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sequence-metadata"><span class="std std-ref">Associating a Sequence with the MetaData</span></a> - full discussion of the
<a class="reference internal" href="#sqlalchemy.schema.Sequence.params.metadata" title="sqlalchemy.schema.Sequence"><code class="xref py py-paramref docutils literal"><span class="pre">Sequence.metadata</span></code></a> parameter.</p>
</div>
</li>
<li><span class="target" id="sqlalchemy.schema.Sequence.params.for_update"></span><strong>for_update</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.schema.Sequence.params.for_update">¶</a> – Indicates this <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>, when associated
with a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>, should be invoked for UPDATE statements
on that column’s table, rather than for INSERT statements, when
no value is otherwise present for that column in the statement.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.schema.Sequence.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>bind=None</em>, <em>checkfirst=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.Sequence.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates this sequence in the database.</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.schema.Sequence.drop">
<code class="descname">drop</code><span class="sig-paren">(</span><em>bind=None</em>, <em>checkfirst=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.Sequence.drop" title="Permalink to this definition">¶</a></dt>
<dd><p>Drops this sequence from the database.</p>
</dd></dl>

<dl class="method">
<dt id="sqlalchemy.schema.Sequence.next_value">
<code class="descname">next_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.schema.Sequence.next_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="functions.html#sqlalchemy.sql.functions.next_value" title="sqlalchemy.sql.functions.next_value"><code class="xref py py-class docutils literal"><span class="pre">next_value</span></code></a> function element
which will render the appropriate increment function
for this <a class="reference internal" href="#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a> within any SQL expression.</p>
</dd></dl>

</dd></dl>

</div>
</div>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links, withsidebar">
        Previous:
        <a href="reflection.html" title="previous chapter">Reflecting Database Objects</a>
        Next:
        <a href="constraints.html" title="next chapter">Defining Constraints and Indexes</a>

    <div id="docs-copyright">
        &copy; <a href="../copyright.html">Copyright</a> 2007-2017, the SQLAlchemy authors and contributors.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
    </div>
</div>

</div>



        
        

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '1.1.15',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>

    <!-- begin iterate through sphinx environment script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    <!-- end iterate through sphinx environment script_files -->

    <script type="text/javascript" src="../_static/detectmobile.js"></script>
    <script type="text/javascript" src="../_static/init.js"></script>


    </body>
</html>


